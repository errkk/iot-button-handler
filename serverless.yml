org: errkk
app: button-lambda
service: button-handler
component: aws-lambda

provider:
  name: aws
  runtime: python3.8
  timeout: 10

  stage: prod
  region: eu-west-2

  iamRoleStatements:
    - Effect: 'Allow'
      Action:
        - 'lambda:ListTags'
        - 'lambda:TagResource'
      Resource:
        - ${param:arn}

  environment:
    arn: ${param:arn}
    hue_application_key: ${param:hue_application_key}
    hue_client_id: ${param:hue_client_id}
    hue_client_secret: ${param:hue_client_secret}
    sonos_client_id: ${param:sonos_client_id}
    sonos_client_secret: ${param:sonos_client_secret}

package:
  include:
    - v-env/lib/python3.8/site-packages/**
    - src/*
  exclude:
    - .env

plugins:
  - serverless-python-requirements
custom:
  pythonRequirements:
     dockerizePip: false
     pythonBin: python3

functions:
  main:
    handler: handler.main
    environment:
      hue_token_key: hueToken
